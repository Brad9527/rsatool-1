import unittest
from rsatool.Hastad import *


class Test(unittest.TestCase):
	def test_crack(self):
		ns = [
			682462987687024357503868159735092590151232205666364233814721,
			874943641662225380351990049062871491634533655253062996576127,595575522847728506864271698447515392757634195971506734877949
		]
		e = 3
		cs =  [
			488644311551308140708291698941346402327468584790247553185020,
			48441125262939082769925102728751424069127717316943898145558,
			430514912653902616746454453600658091803257075572923390231565
		]

		attack = Hastad(ns, e, cs)
		self.assertTrue(attack.crack())
		
		self.assertEquals(attack.plain, 'Alan Turing')


if __name__ == '__main__':
	unittest.main()