import unittest
from rsatool.Wiener import *


class Test(unittest.TestCase):
   def test_crack(self):
      n = 442947352273386069472186483278731300137005728764780792214039954401334107945848187878587637461616428339445226582677733051188386680813104063865125612194005295498927770728197360169579892170737223117379837998048177651429023478976033023519347032220852775956917489386095056457794916285307072646058950303421346179479
      e = 369820094872903652064226254322873129219379872672982553592109200895068495465712264497045617401916958789696282002444070987080305214440714916297763902424339055047037720997528933977608572915126395722230477436824001884639586516977780252738046972254345554948430074141501101048253630398218098611954097364802405934351

      attack = Wiener(n, e)
      self.assertTrue(attack.crack())
      self.assertEquals(attack.d, 29796586667279639258691091822621519573554498054417602530889366632900236018423)
      

if __name__ == '__main__':
   unittest.main()